<source>
  @type tail
  @id postgres_querylog
  path @@@DOCKER_POSTGRES_QUERYLOG@@@
  pos_file /var/log/fluentd-pos/postgres-querylog.pos
  tag postgres.querylog
  <parse>
    @type json
  </parse>
</source>

<filter postgres.querylog>
  @type parser
  format json
  key_name log
  <parse>
    @type multi_format
    <pattern>
      format json
      key_name log
      time_parse true
      time_key time
      time_format %Y-%m-%d\ %H:%M:%S
    </pattern>
    <pattern>
      format /^(?<message>.*)$/
    </pattern>
  </parse>
</filter>

